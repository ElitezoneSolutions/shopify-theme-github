{% comment %}
  Custom Flex Section
  - This section uses a flexbox layout similar to your provided code.
  - It includes three block types:
      1. Content Block (heading and paragraph)
      2. Image Block (image picker)
      3. Video Block (video URL with mute, autoplay, loop, and controls options)
  - A section setting allows you to choose a color scheme.
{% endcomment %}

<style>
  /* Base Styles */
  body {
      font-family: 'inter', sans-serif;
      padding: 0;
  }
  .container {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      padding: 20px;
      gap: 20px;
      max-width: 1200px;
      margin: auto;
      background-color: #f0f0f0;
  }
  .feature-content {
      display: flex;
      flex-direction: column;
      gap: 20px;
      flex: 1;
      min-width: 300px;
  }
  .content {
      padding: 20px;
      text-align: center;
  }
  #image {
      flex: 1;
      text-align: center;
      min-width: 300px;
  }
  #image img {
      width: 100%;
      max-width: 400px;
  }
  .video-block {
      flex: 1;
      text-align: center;
      min-width: 300px;
  }
  .video-block video {
      width: 100%;
      max-width: 400px;
  }
  @media (max-width: 767px) {
      .feature-content {
          flex-direction: row;
      }
      .content {
          flex: 1;
          padding: 0px;
      }
      #image, .video-block {
          flex: 1;
      }
  }
</style>

<div class="container {{ section.settings.color_scheme }}">
  {% for block in section.blocks %}
    {% case block.type %}
      {% when 'content' %}
        <div class="feature-content">
          <div class="content">
            {% if block.settings.heading != blank %}
              <h3>{{ block.settings.heading }}</h3>
            {% endif %}
            {% if block.settings.paragraph != blank %}
              <p>{{ block.settings.paragraph }}</p>
            {% endif %}
          </div>
        </div>
      {% when 'image' %}
        <div id="image">
          {% if block.settings.image != blank %}
            <img src="{{ block.settings.image | img_url: '600x400' }}" alt="Image">
          {% endif %}
        </div>
      {% when 'video' %}
        <div class="video-block">
          {% assign video_url = block.settings.video_url
            | default: 'https://cdn.shopify.com/videos/c/vp/dd0d65a8ee0b412187e96eec6a907150/dd0d65a8ee0b412187e96eec6a907150.HD-1080p-2.5Mbps-43033818.mp4'
          %}
          <video
            width="600"
            height="400"
            {% if block.settings.autoplay %}
              autoplay
            {% endif %}
            {% if block.settings.loop %}
              loop
            {% endif %}
            {% if block.settings.mute %}
              muted
            {% endif %}
            {% if block.settings.controls %}
              controls
            {% endif %}
          >
            <source src="{{ video_url }}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
    {% endcase %}
  {% endfor %}
</div>

{% schema %}
{
  "name": "Custom Flex Section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "light"
    }
  ],
  "blocks": [
    {
      "type": "content",
      "name": "Content Block",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Your Heading"
        },
        {
          "type": "textarea",
          "id": "paragraph",
          "label": "Paragraph",
          "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus lacinia odio vitae vestibulum vestibulum."
        }
      ]
    },
    {
      "type": "image",
      "name": "Image Block",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    },
    {
      "type": "video",
      "name": "Video Block",
      "settings": [
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL"
        },
        {
          "type": "checkbox",
          "id": "mute",
          "label": "Mute",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "autoplay",
          "label": "Autoplay",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "loop",
          "label": "Loop",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "controls",
          "label": "Show Controls",
          "default": true
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Flex Section",
      "category": "Custom"
    }
  ]
}
{% endschema %}
